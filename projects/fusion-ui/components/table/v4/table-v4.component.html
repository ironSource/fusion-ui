<!--<div class="fu-table-header">Table Header</div>-->
<div #tableWrapper class="tableWrap" [ngClass]="wrapperClasses">
    @if(!tableMainError){
        <table [id]="id" #table>
            @if(columns && options){
                <!-- region Table Header-->
                @if(columns.length){
                    <thead [hidden]="(isEmpty || (loading && !isLoadingOverlay)) && hideHeaderOnEmpty">
                    <!-- region SubHeader-->
                    @if(subHeader.length){
                        <tr>
                            <!--<ng-container *ngIf="!!options?.rowsExpandableOptions" [ngTemplateOutlet]="headerExpandColumn" [ngTemplateOutletContext]="{$implicit: true}"></ng-container>-->
                            @for(subheader of subHeader; track subHeader; let isFirst = $first){
                                <td class="fu-header-group"
                                    [class.fu-border-left]="!isFirst"
                                    [attr.colspan]="(isFirst && !!options?.rowsExpandableOptions) ? subheader.colspan + 1 : subheader.colspan"
                                >
                                    {{ subheader.name}}
                                </td>
                            }
                        </tr>
                    }
                    <!-- endregion SubHeader-->
                    <!-- region Header-->
                    <tr [ngStyle]="!!options.rowsOptions && !!options.rowsOptions.headerRow ? options.rowsOptions.headerRow.style : null">
                        <!--<ng-container *ngIf="!!options?.rowsExpandableOptions" [ngTemplateOutlet]="headerExpandColumn"></ng-container>-->
                        @for (column of columns; track trackByFunc; let isLast = $last; let isFirst = $first; let idx = $index){
                            <td
                                    [attr.data-col-key]="column.key"
                                    [ngClass]="tableService.getColumnClasses(column, true)"
                                    [ngStyle]="tableService.getColumnStyle(column)"
                                    (click)="onHeaderClicked(column)"
                                    [style.width]="tableService.setWidth(isLast, column.width)"
                                    [style.text-align]="column.headerAlign"
                                    [attr.colspan]="isFirst ? (tableService.expandLevels + 1) : undefined"
                                    [style.top.px]="options?.stickyHeaderTopOffset"
                                    [attr.data-testid]="testIdsService.getTestAttribute.bind(this) | generic:testId:(tableTestIdModifiers.COLUMN_HEADER+idx)"
                            >
                                <ng-container>
                                    <div class="fu-header-text"
                                         [class.fu-tooltiped]="column.tooltip" [fusionTooltip]="column.tooltip"
                                         [attr.data-testid]="testIdsService.getTestAttribute.bind(this) | generic:testId:(tableTestIdModifiers.COLUMN_TITLE+idx)"
                                    >{{ column.title }}</div>
                                    <div class="fu-sort-wrapper">
                                        <div class="fu-sort-up" [attr.data-testid]="testIdsService.getTestAttribute.bind(this) | generic:testId:(tableTestIdModifiers.COLUMN_SORT_UP+idx)"></div>
                                        <div class="fu-sort-down" [attr.data-testid]="testIdsService.getTestAttribute.bind(this) | generic:testId:(tableTestIdModifiers.COLUMN_SORT_DOWN+idx)"></div>
                                    </div>
                                </ng-container>
                                <!--                        <fusion-multi-dropdown
                                                                *ngIf="column.filter && column.filter.options"
                                                                placeholder="Please Select"
                                                                class="filter"
                                                                [selected]="column.filter.selected"
                                                                [options]="column.filter.options"
                                                                (selectedChange)="filterColumn(column, $event)"
                                                                [confirm]="true"
                                                                [search]="true"
                                                                selectAllLabel="Select All <span class='grey'>(No Filters)</span>"
                                                        >
                                                        </fusion-multi-dropdown>-->
                                @if (tableService.isTypeCheckbox(column) && isAllRowsSelectable && !isEmpty && isCheckboxTitleShown){
                                    <fusion-checkbox class="is-regular" title="select / un-select all"
                                            [checked]="tableService.isAllRowsSelected(rows)"
                                            [isIndeterminate]="tableService.isPartialSelected(rows)"
                                            (changed)="tableService.onRowsSelectChanged(options.isGroupedTable, rows, $event)"
                                            [attr.data-testid]="testIdsService.getTestAttribute.bind(this) | generic:testId:tableTestIdModifiers.COLUMN_HEADER_SELECT_ALL"
                                    ></fusion-checkbox>
                                }
                            </td>
                        }
                    </tr>
                    <!-- endregion Header-->
                    </thead>
                }
                <!-- endregion Table Header-->
                <!-- region Table Body-->
                @if(loading && !isLoadingOverlay){
                    <tbody [fusionTableLoading]="colsCount"></tbody>
                }
                @if(!options.isGroupedTable && (!loading || isLoadingOverlay) && !isEmpty){
                    <!--                <tbody
                                            *ngIf=""
                                            fusionTableBasic
                                            [rows]="tableRows"
                                            [columns]="columns"
                                            [options]="options"
                                            [tableClientWidth]="getTableClientWidth()"
                                            [expandedRows]="expandedRows"
                                            [testId]="testId"
                                            (rowSelected)="selectionChanged.emit($event)"
                                            (expandRow)="doExpandRow($event)"
                                            (click)="onTableBodyClicked($event)"
                                            #tableBody
                                    ></tbody>-->
                }
                @if(options?.pagination && options.pagination.loading){
                    <!--table pagination loading overlay -->
                    <tbody [fusionTableLoading]="colsCount"></tbody>
                }
                <!-- region Grouped Table Body-->
<!--
                <tbody
                        *ngIf="options.isGroupedTable && (!loading || isLoadingOverlay) && !isEmpty"
                        fusionTableGrouped
                        [rows]="groupedTableRows"
                        [columns]="columns"
                        [options]="options"
                        (rowSelected)="selectionChanged.emit($event)"
                ></tbody>
-->
                <!-- endregion Grouped Table Body-->
                <!-- endregion Table Body-->
            }
            <!-- region table empty-->
            @if (!loading && isEmpty){
                <!--
                            <tbody
                                    [fusionTableEmpty]="colsCount"
                                    [customContent]="options?.customNoData"
                                    [header]="noDataMessage"
                                    [subHeader]="noDataSubMessage"
                                    [icon]="options?.emptyTableIcon"
                                    [imageBackgroundUrl]="options?.noDataImageBgUrl"
                            ></tbody>
                -->
            }
            <!-- endregion table empty-->
            <!-- region table empty loading-->
            @if(isEmpty && loading){
                <tbody [fusionTableLoading]="colsCount"></tbody>
            }
            <!-- endregion table empty loading-->
        </table>
    }
</div>
<!--<div class="fu-table-footer">Footer</div>-->
