<div
    [id]="id"
    class="is-tags-holder"
    (click)="setFocusToInput()"
    [clickOutsideActivate]="isOpen$ | async"
    (fusionClickOutside)="onOutsideClick()"
    [ngClass]="{'is-icon-right-position': isIconRightPosition, 'dd-opened': isOpen$ | async, 'ss-selected': selected?.length > 0}"
    [class.tags-disabled]="isDisabled"
    [class.is-autocomplete]="autoComplete"
    *ngIf="selectedVersion$ | async as currentStyleVersion"
>
    <!--tags list holder-->
    <ul class="tags-holder" [ngStyle]="{'max-height.px': maxHeight}">
        <li *ngFor="let tag of (displaySelectedTags$ | async)">
            <fusion-tag
                [close]="true"
                (onRemove)="onTagRemove(tag)"
                [icon]="tag.icon"
                [flag]="tag.flag"
                [suppressClickOnRemove]="suppressClickOnRemove"
                [tooltipContent]="tag.tooltip ? tag.tooltip : tag.title"
                [disabled]="isDisabled"
                >{{ tag.title }}</fusion-tag
            >
        </li>
        <li class="search-container">
            <fusion-input
                #tagInput
                [formControl]="searchValue"
                *ngIf="!isDisabled && (isAddTagsAllowed || autoComplete)"
                [hidden]="isDisabled"
                [loading]="loading && bulkInsertion"
                [iconPos]="'right'"
                [placeholder]="displayPlaceholder"
                (ngEnter)="onEnterNewTag($event)"
                [options]="{size: 'small'}"
            ></fusion-input>
            <span class="placeholder" *ngIf="isDisabled">
                {{ displayPlaceholder }}
            </span>
        </li>
    </ul>
    <!--tags list holder END-->
    <ng-container *ngIf="!bulkInsertion">
        <div
            class="options-dropdown"
            [ngClass]="{'dd-scroll': hasScroll}"
            *ngIf="(searchValue.value || (filteredDisplayedOptions$ | async)?.length || loading) && !generateOnlyCustomTags"
        >
            <div class="options-holder" (scroll)="onScroll($event)" #optionsHolder>
                <ul class="options">
                    <li [fusionDropdownLoader]="autoComplete && loading" class="auto-complete-loading"></li>
                    <li *ngIf="isNoResults() && !isAddTagsAllowed" class="no-results">{{ noResultMessage }}</li>
                    <li *ngIf="isPredefinedTags && isAddCustomTag && currentStyleVersion === styleVersion.V1" class="auto-complete-loading">
                        <a class="is-add-tag" href="#" (click)="addCustomPredefinedTag($event)"> Create new tag: </a>"{{
                            searchValue.value
                        }}"
                    </li>

                    <fusion-dropdown-options-list
                        [displayedOptions]="filteredDisplayedOptions$ | async"
                        [isMultiRawDisplay]="isMultiRawDisplay"
                        [mappingOptions]="mappingOptions"
                        (changeSelected)="changeSelected({option: $event.option, $event: $event.$event})"
                    >
                    </fusion-dropdown-options-list>
                </ul>
            </div>
        </div>
    </ng-container>
</div>
<div class="error-msg" *ngIf="error">{{ error }}</div>
